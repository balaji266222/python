import pygame
import random

pygame.init()

WIDTH, HEIGHT = 900, 600
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("Element Clash - Solo Mode")

clock = pygame.time.Clock()
FPS = 60

WHITE = (255, 255, 255)
BLACK = (0, 0, 0)
ELEMENT_COLORS = {
    "Fire": (255, 69, 0),
    "Water": (30, 144, 255),
    "Grass": (34, 139, 34),
    "Wind": (135, 206, 250),
}

font = pygame.font.SysFont(None, 40)

arrow_speed = 7
player_arrow = {"x": 100, "y": HEIGHT // 2, "active": False, "element": ""}
enemy_arrow = {"x": WIDTH - 100, "y": HEIGHT // 2, "active": False, "element": ""}

player_score = 0
enemy_score = 0
result_text = ""

def determine_winner(p, e):
    if p == e or "Wind" in (p, e):
        return "Draw"
    rules = {"Fire": "Grass", "Water": "Fire", "Grass": "Water"}
    return "Player" if rules[p] == e else "Enemy"

def random_element():
    return random.choice(["Fire", "Water", "Grass", "Wind"])

def draw_text(text, x, y, color=BLACK):
    label = font.render(text, True, color)
    screen.blit(label, (x, y))

running = True
while running:
    screen.fill(WHITE)

    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False

        if event.type == pygame.KEYDOWN and not player_arrow["active"]:
            keys_to_elements = {
                pygame.K_1: "Fire",
                pygame.K_2: "Water",
                pygame.K_3: "Grass",
                pygame.K_4: "Wind"
            }
            if event.key in keys_to_elements:
                player_arrow["element"] = keys_to_elements[event.key]
                player_arrow["active"] = True
                player_arrow["x"] = 100

                enemy_arrow["element"] = random_element()
                enemy_arrow["active"] = True
                enemy_arrow["x"] = WIDTH - 100

    if player_arrow["active"]:
        player_arrow["x"] += arrow_speed
    if enemy_arrow["active"]:
        enemy_arrow["x"] -= arrow_speed

    if player_arrow["active"]:
        pygame.draw.rect(screen, ELEMENT_COLORS[player_arrow["element"]],
                         (player_arrow["x"], player_arrow["y"], 40, 5))
        draw_text(player_arrow["element"], player_arrow["x"] - 10, player_arrow["y"] - 30)

    if enemy_arrow["active"]:
        pygame.draw.rect(screen, ELEMENT_COLORS[enemy_arrow["element"]],
                         (enemy_arrow["x"], enemy_arrow["y"], 40, 5))
        draw_text(enemy_arrow["element"], enemy_arrow["x"] - 10, enemy_arrow["y"] - 30)

    if player_arrow["active"] and enemy_arrow["active"]:
        if abs(player_arrow["x"] - enemy_arrow["x"]) < 40:
            winner = determine_winner(player_arrow["element"], enemy_arrow["element"])
            if winner == "Player":
                player_score += 1
                result_text = "✅ You Win the Clash!"
            elif winner == "Enemy":
                enemy_score += 1
                result_text = "❌ Enemy Wins the Clash!"
            else:
                result_text = "🤝 It's a Draw!"
            player_arrow["active"] = False
            enemy_arrow["active"] = False

    draw_text("Choose Element: 1-Fire 2-Water 3-Grass 4-Wind", 200, 20)
    draw_text(f"Your Score: {player_score}", 20, 60)
    draw_text(f"Enemy Score: {enemy_score}", WIDTH - 230, 60)
    draw_text(result_text, WIDTH // 2 - 150, 100)

    pygame.display.flip()
    clock.tick(FPS)

pygame.quit()
